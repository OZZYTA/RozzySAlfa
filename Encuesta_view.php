<?php
// This script and data application were generated by AppGini 5.97
// Download AppGini for free from https://bigprof.com/appgini/download/

	$currDir = dirname(__FILE__);
	include_once("{$currDir}/lib.php");
	@include_once("{$currDir}/hooks/Encuesta.php");
	include_once("{$currDir}/Encuesta_dml.php");

	// mm: can the current member access this page?
	$perm = getTablePermissions('Encuesta');
	if(!$perm['access']) {
		echo error_message($Translation['tableAccessDenied']);
		exit;
	}

	$x = new DataList;
	$x->TableName = 'Encuesta';

	// Fields that can be displayed in the table view
	$x->QueryFieldsTV = [
		"`Encuesta`.`id`" => "id",
		"if(`Encuesta`.`fecha`,date_format(`Encuesta`.`fecha`,'%d/%m/%Y'),'')" => "fecha",
		"`Encuesta`.`tipoid`" => "tipoid",
		"`Encuesta`.`doc`" => "doc",
		"`Encuesta`.`nombres`" => "nombres",
		"`Encuesta`.`apellidos`" => "apellidos",
		"IF(    CHAR_LENGTH(`eps1`.`razonsocial`), CONCAT_WS('',   `eps1`.`razonsocial`), '') /* EPS */" => "eps",
		"IF(    CHAR_LENGTH(`ips1`.`nombre`), CONCAT_WS('',   `ips1`.`nombre`), '') /* IPS Primaria */" => "ipsprim",
		"`Encuesta`.`tratoser`" => "tratoser",
		"`Encuesta`.`cita`" => "cita",
		"`Encuesta`.`tratoasis`" => "tratoasis",
		"`Encuesta`.`expprof`" => "expprof",
		"`Encuesta`.`bioser`" => "bioser",
		"`Encuesta`.`area`" => "area",
		"`Encuesta`.`pyp`" => "pyp",
		"`Encuesta`.`prenatal`" => "prenatal",
		"`Encuesta`.`cyd`" => "cyd",
		"`Encuesta`.`vacunas`" => "vacunas",
		"`Encuesta`.`pfm`" => "pfm",
		"`Encuesta`.`citologia`" => "citologia",
		"`Encuesta`.`sservicio`" => "sservicio",
		"`Encuesta`.`incomodo`" => "incomodo",
		"`Encuesta`.`otro`" => "otro",
		"`Encuesta`.`why`" => "why",
		"`Encuesta`.`urgencia`" => "urgencia",
		"`Encuesta`.`citaoportuna`" => "citaoportuna",
		"`Encuesta`.`aspectoeps`" => "aspectoeps",
		"`Encuesta`.`fisicas`" => "fisicas",
		"`Encuesta`.`aseo`" => "aseo",
		"`Encuesta`.`capacitacion`" => "capacitacion",
		"`Encuesta`.`autorizaciones`" => "autorizaciones",
		"`Encuesta`.`general`" => "general",
		"`Encuesta`.`horario`" => "horario",
		"`Encuesta`.`formulario`" => "formulario",
		"`Encuesta`.`farmacia`" => "farmacia",
		"`Encuesta`.`fisicasfarma`" => "fisicasfarma",
		"`Encuesta`.`oporfarmacia`" => "oporfarmacia",
		"`Encuesta`.`totalidad`" => "totalidad",
		"`Encuesta`.`cambio`" => "cambio",
		"`Encuesta`.`volver`" => "volver",
		"`Encuesta`.`orientacion`" => "orientacion",
		"`Encuesta`.`embalaje`" => "embalaje",
		"`Encuesta`.`revision`" => "revision",
		"`Encuesta`.`observaciones`" => "observaciones",
		"`Encuesta`.`user`" => "user",
	];
	// mapping incoming sort by requests to actual query fields
	$x->SortFields = [
		1 => '`Encuesta`.`id`',
		2 => '`Encuesta`.`fecha`',
		3 => 3,
		4 => 4,
		5 => 5,
		6 => 6,
		7 => '`eps1`.`razonsocial`',
		8 => '`ips1`.`nombre`',
		9 => 9,
		10 => 10,
		11 => 11,
		12 => 12,
		13 => 13,
		14 => 14,
		15 => 15,
		16 => 16,
		17 => 17,
		18 => 18,
		19 => 19,
		20 => 20,
		21 => 21,
		22 => 22,
		23 => 23,
		24 => 24,
		25 => 25,
		26 => 26,
		27 => 27,
		28 => 28,
		29 => 29,
		30 => 30,
		31 => 31,
		32 => 32,
		33 => 33,
		34 => 34,
		35 => 35,
		36 => 36,
		37 => 37,
		38 => 38,
		39 => 39,
		40 => 40,
		41 => 41,
		42 => 42,
		43 => 43,
		44 => 44,
		45 => 45,
	];

	// Fields that can be displayed in the csv file
	$x->QueryFieldsCSV = [
		"`Encuesta`.`id`" => "id",
		"if(`Encuesta`.`fecha`,date_format(`Encuesta`.`fecha`,'%d/%m/%Y'),'')" => "fecha",
		"`Encuesta`.`tipoid`" => "tipoid",
		"`Encuesta`.`doc`" => "doc",
		"`Encuesta`.`nombres`" => "nombres",
		"`Encuesta`.`apellidos`" => "apellidos",
		"IF(    CHAR_LENGTH(`eps1`.`razonsocial`), CONCAT_WS('',   `eps1`.`razonsocial`), '') /* EPS */" => "eps",
		"IF(    CHAR_LENGTH(`ips1`.`nombre`), CONCAT_WS('',   `ips1`.`nombre`), '') /* IPS Primaria */" => "ipsprim",
		"`Encuesta`.`tratoser`" => "tratoser",
		"`Encuesta`.`cita`" => "cita",
		"`Encuesta`.`tratoasis`" => "tratoasis",
		"`Encuesta`.`expprof`" => "expprof",
		"`Encuesta`.`bioser`" => "bioser",
		"`Encuesta`.`area`" => "area",
		"`Encuesta`.`pyp`" => "pyp",
		"`Encuesta`.`prenatal`" => "prenatal",
		"`Encuesta`.`cyd`" => "cyd",
		"`Encuesta`.`vacunas`" => "vacunas",
		"`Encuesta`.`pfm`" => "pfm",
		"`Encuesta`.`citologia`" => "citologia",
		"`Encuesta`.`sservicio`" => "sservicio",
		"`Encuesta`.`incomodo`" => "incomodo",
		"`Encuesta`.`otro`" => "otro",
		"`Encuesta`.`why`" => "why",
		"`Encuesta`.`urgencia`" => "urgencia",
		"`Encuesta`.`citaoportuna`" => "citaoportuna",
		"`Encuesta`.`aspectoeps`" => "aspectoeps",
		"`Encuesta`.`fisicas`" => "fisicas",
		"`Encuesta`.`aseo`" => "aseo",
		"`Encuesta`.`capacitacion`" => "capacitacion",
		"`Encuesta`.`autorizaciones`" => "autorizaciones",
		"`Encuesta`.`general`" => "general",
		"`Encuesta`.`horario`" => "horario",
		"`Encuesta`.`formulario`" => "formulario",
		"`Encuesta`.`farmacia`" => "farmacia",
		"`Encuesta`.`fisicasfarma`" => "fisicasfarma",
		"`Encuesta`.`oporfarmacia`" => "oporfarmacia",
		"`Encuesta`.`totalidad`" => "totalidad",
		"`Encuesta`.`cambio`" => "cambio",
		"`Encuesta`.`volver`" => "volver",
		"`Encuesta`.`orientacion`" => "orientacion",
		"`Encuesta`.`embalaje`" => "embalaje",
		"`Encuesta`.`revision`" => "revision",
		"`Encuesta`.`observaciones`" => "observaciones",
		"`Encuesta`.`user`" => "user",
	];
	// Fields that can be filtered
	$x->QueryFieldsFilters = [
		"`Encuesta`.`id`" => "ID",
		"`Encuesta`.`fecha`" => "Fecha",
		"`Encuesta`.`tipoid`" => "Tipo de Documento:",
		"`Encuesta`.`doc`" => "Numero de Documento",
		"`Encuesta`.`nombres`" => "Nombres",
		"`Encuesta`.`apellidos`" => "Apellidos",
		"IF(    CHAR_LENGTH(`eps1`.`razonsocial`), CONCAT_WS('',   `eps1`.`razonsocial`), '') /* EPS */" => "EPS",
		"IF(    CHAR_LENGTH(`ips1`.`nombre`), CONCAT_WS('',   `ips1`.`nombre`), '') /* IPS Primaria */" => "IPS Primaria",
		"`Encuesta`.`tratoser`" => "Al Utilizar el Servicio &#191;El trato Fue?",
		"`Encuesta`.`cita`" => "&#191;La asignaci&#243;n de citas para el servicio fue?",
		"`Encuesta`.`tratoasis`" => "&#191;El trato que recibi&#243; y el tiempo dedicado por parte del personal asistencial fue?",
		"`Encuesta`.`expprof`" => "&#191;La explicaci&#243;n dada por el profesional de la salud, sobre el cuidado tratamiento y mantenimiento de la salud fue?",
		"`Encuesta`.`bioser`" => "&#191;Las condiciones de bioseguridad (uso de tapabocas, canecas, guantes, etc) utilizadas por los profesionales de la salud fueron?",
		"`Encuesta`.`area`" => "&#191;C&#243;mo califica el &#225;rea donde fue antendido en cuanto a aseo y comodidad?",
		"`Encuesta`.`pyp`" => "Lo han invitado a programas de Promoci&#243;n y Prevenci&#243;n?",
		"`Encuesta`.`prenatal`" => "Asiste a Control Prenatal? (Solo mujeres embarazadas)",
		"`Encuesta`.`cyd`" => "Sus hijos menores de 10 a&#241;os asisten a control de crecimiento y desarrollo?",
		"`Encuesta`.`vacunas`" => "&#191;Sus hijos menores de 5 a&#241;os han sido vacunados?",
		"`Encuesta`.`pfm`" => "&#191;Qu&#233; m&#233;todo de planificaci&#243;n familiar usa?",
		"`Encuesta`.`citologia`" => "&#191;Cu&#225;ndo fue su &#250;ltima citolog&#237;a?",
		"`Encuesta`.`sservicio`" => "Califique su satisfacci&#243;n con el servicio recibido en el centro de salud",
		"`Encuesta`.`incomodo`" => "&#191;Especialmente con cual de los servicios se ha sentido incomodo?",
		"`Encuesta`.`otro`" => "Otro",
		"`Encuesta`.`why`" => "&#191;Por qu&#233;?",
		"`Encuesta`.`urgencia`" => "&#191;Lo han atendido oportunamente cuando se ha presentado una urgencia?",
		"`Encuesta`.`citaoportuna`" => "&#191;La asignaci&#243;n de citas ha sido oportuna?",
		"`Encuesta`.`aspectoeps`" => "Al utilizar el servicio &#191;el trato que recibi&#243; fue?",
		"`Encuesta`.`fisicas`" => "Las condiciones fisicas en las instalaciones de la EPS son?",
		"`Encuesta`.`aseo`" => "El &#225;rea donde fue atendido en cuanto a aseo, higiene y comodidad es:",
		"`Encuesta`.`capacitacion`" => "&#191;La capacitaci&#243;n brindada por la EPS sobre sus derechos y deberes fue?",
		"`Encuesta`.`autorizaciones`" => "La gesti&#243;n de las autorizaciones y/o tratamientos por parte de la EPS fue?",
		"`Encuesta`.`general`" => "Ud considera que la EPS en general es?",
		"`Encuesta`.`horario`" => "El personal de la EPS lo atiende oportunamente dentro del horario de atenci&#243;n al p&#250;blico?",
		"`Encuesta`.`formulario`" => "El personal administrativo de la EPS le entreg&#243; copia del formulario de afiliaci&#243;n y/o traslado?",
		"`Encuesta`.`farmacia`" => "Como fue el trato que recibio por parte del personal de famarcia que lo ha atendido?",
		"`Encuesta`.`fisicasfarma`" => "Las condiciones fisicas en la prestaci&#243;n del servicio de farmacia y/o drogueria fue?",
		"`Encuesta`.`oporfarmacia`" => "&#191;La oportunidad en la prestaci&#243;n del servicio de farmacia y/o droguer&#237;a fue? ",
		"`Encuesta`.`totalidad`" => "&#191;Le entregaron la totalidad de los medicamentos? ",
		"`Encuesta`.`cambio`" => "&#191;Le gustar&#237;a que la EPS cambiara el servicio de farmacia y/o droguer&#237;a?",
		"`Encuesta`.`volver`" => "&#191;Cu&#225;ntas veces ha tenido que volver a la farmacia y/o droguer&#237;a por medicamentos pendientes?",
		"`Encuesta`.`orientacion`" => "&#191;La persona encargada de suministrar la medicina, le orienta en el consumo y conservaci&#243;n de los medicamentos? ",
		"`Encuesta`.`embalaje`" => "&#191;En qu&#233; condiciones le entregan a usted el medicamento en el servicio de farmacia y/o droguer&#237;a?",
		"`Encuesta`.`revision`" => "&#191;El personal que lo atendi&#243; revis&#243; con usted los medicamentos antes de hacer la entrega? ",
		"`Encuesta`.`observaciones`" => "Observaciones",
		"`Encuesta`.`user`" => "Realizada por",
	];

	// Fields that can be quick searched
	$x->QueryFieldsQS = [
		"`Encuesta`.`id`" => "id",
		"if(`Encuesta`.`fecha`,date_format(`Encuesta`.`fecha`,'%d/%m/%Y'),'')" => "fecha",
		"`Encuesta`.`tipoid`" => "tipoid",
		"`Encuesta`.`doc`" => "doc",
		"`Encuesta`.`nombres`" => "nombres",
		"`Encuesta`.`apellidos`" => "apellidos",
		"IF(    CHAR_LENGTH(`eps1`.`razonsocial`), CONCAT_WS('',   `eps1`.`razonsocial`), '') /* EPS */" => "eps",
		"IF(    CHAR_LENGTH(`ips1`.`nombre`), CONCAT_WS('',   `ips1`.`nombre`), '') /* IPS Primaria */" => "ipsprim",
		"`Encuesta`.`tratoser`" => "tratoser",
		"`Encuesta`.`cita`" => "cita",
		"`Encuesta`.`tratoasis`" => "tratoasis",
		"`Encuesta`.`expprof`" => "expprof",
		"`Encuesta`.`bioser`" => "bioser",
		"`Encuesta`.`area`" => "area",
		"`Encuesta`.`pyp`" => "pyp",
		"`Encuesta`.`prenatal`" => "prenatal",
		"`Encuesta`.`cyd`" => "cyd",
		"`Encuesta`.`vacunas`" => "vacunas",
		"`Encuesta`.`pfm`" => "pfm",
		"`Encuesta`.`citologia`" => "citologia",
		"`Encuesta`.`sservicio`" => "sservicio",
		"`Encuesta`.`incomodo`" => "incomodo",
		"`Encuesta`.`otro`" => "otro",
		"`Encuesta`.`why`" => "why",
		"`Encuesta`.`urgencia`" => "urgencia",
		"`Encuesta`.`citaoportuna`" => "citaoportuna",
		"`Encuesta`.`aspectoeps`" => "aspectoeps",
		"`Encuesta`.`fisicas`" => "fisicas",
		"`Encuesta`.`aseo`" => "aseo",
		"`Encuesta`.`capacitacion`" => "capacitacion",
		"`Encuesta`.`autorizaciones`" => "autorizaciones",
		"`Encuesta`.`general`" => "general",
		"`Encuesta`.`horario`" => "horario",
		"`Encuesta`.`formulario`" => "formulario",
		"`Encuesta`.`farmacia`" => "farmacia",
		"`Encuesta`.`fisicasfarma`" => "fisicasfarma",
		"`Encuesta`.`oporfarmacia`" => "oporfarmacia",
		"`Encuesta`.`totalidad`" => "totalidad",
		"`Encuesta`.`cambio`" => "cambio",
		"`Encuesta`.`volver`" => "volver",
		"`Encuesta`.`orientacion`" => "orientacion",
		"`Encuesta`.`embalaje`" => "embalaje",
		"`Encuesta`.`revision`" => "revision",
		"`Encuesta`.`observaciones`" => "observaciones",
		"`Encuesta`.`user`" => "user",
	];

	// Lookup fields that can be used as filterers
	$x->filterers = ['eps' => 'EPS', 'ipsprim' => 'IPS Primaria', ];

	$x->QueryFrom = "`Encuesta` LEFT JOIN `eps` as eps1 ON `eps1`.`razonsocial`=`Encuesta`.`eps` LEFT JOIN `ips` as ips1 ON `ips1`.`nombre`=`Encuesta`.`ipsprim` ";
	$x->QueryWhere = '';
	$x->QueryOrder = '';

	$x->AllowSelection = 1;
	$x->HideTableView = ($perm['view'] == 0 ? 1 : 0);
	$x->AllowDelete = $perm['delete'];
	$x->AllowMassDelete = true;
	$x->AllowInsert = $perm['insert'];
	$x->AllowUpdate = $perm['edit'];
	$x->SeparateDV = 1;
	$x->AllowDeleteOfParents = 0;
	$x->AllowFilters = 1;
	$x->AllowSavingFilters = (getLoggedAdmin() !== false);
	$x->AllowSorting = 1;
	$x->AllowNavigation = 1;
	$x->AllowPrinting = (getLoggedAdmin() !== false);
	$x->AllowPrintingDV = (getLoggedAdmin() !== false);
	$x->AllowCSV = 1;
	$x->RecordsPerPage = 10;
	$x->QuickSearch = 1;
	$x->QuickSearchText = $Translation['quick search'];
	$x->ScriptFileName = 'Encuesta_view.php';
	$x->RedirectAfterInsert = 'Encuesta_view.php';
	$x->TableTitle = 'Encuestas de Satisfacci&#243;n';
	$x->TableIcon = 'resources/table_icons/statistics.png';
	$x->PrimaryKey = '`Encuesta`.`id`';
	$x->DefaultSortField = '`Encuesta`.`fecha`';
	$x->DefaultSortDirection = 'asc';

	$x->ColWidth = [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, ];
	$x->ColCaption = ['Fecha', 'Tipo de Documento:', 'Numero de Documento', 'Nombres', 'Apellidos', 'EPS', 'IPS Primaria', 'Al Utilizar el Servicio &#191;El trato Fue?', '&#191;La asignaci&#243;n de citas para el servicio fue?', '&#191;El trato que recibi&#243; y el tiempo dedicado por parte del personal asistencial fue?', '&#191;La explicaci&#243;n dada por el profesional de la salud, sobre el cuidado tratamiento y mantenimiento de la salud fue?', '&#191;Las condiciones de bioseguridad (uso de tapabocas, canecas, guantes, etc) utilizadas por los profesionales de la salud fueron?', '&#191;C&#243;mo califica el &#225;rea donde fue antendido en cuanto a aseo y comodidad?', 'Lo han invitado a programas de Promoci&#243;n y Prevenci&#243;n?', 'Asiste a Control Prenatal? (Solo mujeres embarazadas)', 'Sus hijos menores de 10 a&#241;os asisten a control de crecimiento y desarrollo?', '&#191;Sus hijos menores de 5 a&#241;os han sido vacunados?', '&#191;Qu&#233; m&#233;todo de planificaci&#243;n familiar usa?', '&#191;Cu&#225;ndo fue su &#250;ltima citolog&#237;a?', 'Califique su satisfacci&#243;n con el servicio recibido en el centro de salud', '&#191;Especialmente con cual de los servicios se ha sentido incomodo?', 'Otro', '&#191;Por qu&#233;?', '&#191;Lo han atendido oportunamente cuando se ha presentado una urgencia?', '&#191;La asignaci&#243;n de citas ha sido oportuna?', 'Al utilizar el servicio &#191;el trato que recibi&#243; fue?', 'Las condiciones fisicas en las instalaciones de la EPS son?', 'El &#225;rea donde fue atendido en cuanto a aseo, higiene y comodidad es:', '&#191;La capacitaci&#243;n brindada por la EPS sobre sus derechos y deberes fue?', 'La gesti&#243;n de las autorizaciones y/o tratamientos por parte de la EPS fue?', 'Ud considera que la EPS en general es?', 'El personal de la EPS lo atiende oportunamente dentro del horario de atenci&#243;n al p&#250;blico?', 'El personal administrativo de la EPS le entreg&#243; copia del formulario de afiliaci&#243;n y/o traslado?', 'Como fue el trato que recibio por parte del personal de famarcia que lo ha atendido?', 'Las condiciones fisicas en la prestaci&#243;n del servicio de farmacia y/o drogueria fue?', '&#191;La oportunidad en la prestaci&#243;n del servicio de farmacia y/o droguer&#237;a fue? ', '&#191;Le entregaron la totalidad de los medicamentos? ', '&#191;Le gustar&#237;a que la EPS cambiara el servicio de farmacia y/o droguer&#237;a?', '&#191;Cu&#225;ntas veces ha tenido que volver a la farmacia y/o droguer&#237;a por medicamentos pendientes?', '&#191;La persona encargada de suministrar la medicina, le orienta en el consumo y conservaci&#243;n de los medicamentos? ', '&#191;En qu&#233; condiciones le entregan a usted el medicamento en el servicio de farmacia y/o droguer&#237;a?', '&#191;El personal que lo atendi&#243; revis&#243; con usted los medicamentos antes de hacer la entrega? ', 'Observaciones', ];
	$x->ColFieldName = ['fecha', 'tipoid', 'doc', 'nombres', 'apellidos', 'eps', 'ipsprim', 'tratoser', 'cita', 'tratoasis', 'expprof', 'bioser', 'area', 'pyp', 'prenatal', 'cyd', 'vacunas', 'pfm', 'citologia', 'sservicio', 'incomodo', 'otro', 'why', 'urgencia', 'citaoportuna', 'aspectoeps', 'fisicas', 'aseo', 'capacitacion', 'autorizaciones', 'general', 'horario', 'formulario', 'farmacia', 'fisicasfarma', 'oporfarmacia', 'totalidad', 'cambio', 'volver', 'orientacion', 'embalaje', 'revision', 'observaciones', ];
	$x->ColNumber  = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, ];

	// template paths below are based on the app main directory
	$x->Template = 'templates/Encuesta_templateTV.html';
	$x->SelectedTemplate = 'templates/Encuesta_templateTVS.html';
	$x->TemplateDV = 'templates/Encuesta_templateDV.html';
	$x->TemplateDVP = 'templates/Encuesta_templateDVP.html';

	$x->ShowTableHeader = 1;
	$x->TVClasses = "";
	$x->DVClasses = "";
	$x->HasCalculatedFields = true;
	$x->AllowConsoleLog = false;
	$x->AllowDVNavigation = true;

	// hook: Encuesta_init
	$render = true;
	if(function_exists('Encuesta_init')) {
		$args = [];
		$render = Encuesta_init($x, getMemberInfo(), $args);
	}

	if($render) $x->Render();

	// hook: Encuesta_header
	$headerCode = '';
	if(function_exists('Encuesta_header')) {
		$args = [];
		$headerCode = Encuesta_header($x->ContentType, getMemberInfo(), $args);
	}

	if(!$headerCode) {
		include_once("{$currDir}/header.php"); 
	} else {
		ob_start();
		include_once("{$currDir}/header.php");
		echo str_replace('<%%HEADER%%>', ob_get_clean(), $headerCode);
	}

	echo $x->HTML;

	// hook: Encuesta_footer
	$footerCode = '';
	if(function_exists('Encuesta_footer')) {
		$args = [];
		$footerCode = Encuesta_footer($x->ContentType, getMemberInfo(), $args);
	}

	if(!$footerCode) {
		include_once("{$currDir}/footer.php"); 
	} else {
		ob_start();
		include_once("{$currDir}/footer.php");
		echo str_replace('<%%FOOTER%%>', ob_get_clean(), $footerCode);
	}
